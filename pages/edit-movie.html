<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Movie</title>
    <link rel="stylesheet" href="../styles/mainstyle.css">
    <link rel="stylesheet" href="../styles/edit-moviestyle.css">
    <script src="../script/movieList.js" defer></script>
</head>

<body>
    <header>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="movieList.html">Movie List</a></li>
                <li><a href="edit-movie.html">Edit a Movie</a></li>
                <li><a href="userRegistrationForm.html">User Registration</a></li>
            </ul>
        </nav>
    </header>
<div class="form-container">
    <h2>Edit Movie Details</h2>

<select id="editMovieDropdown" onchange="populateForm()">
    <!-- Options will be populated from movieList in localStorage -->
</select>

<form id="editMovieForm">
    <label>Name:
        <input type="text" id="editName">
    </label><br>
    <label>Genre:
        <input type="text" id="editGenre">
    </label><br>
    <label>Year:
        <input type="number" id="editYear">
    </label><br>
    <label>Rating:
        <input type="number" id="editRating">
    </label><br>
    <button type="button" onclick="updateMovieDetails()">Update Movie</button>
</form>
</div>


<script>
    document.addEventListener('DOMContentLoaded', function() {
        populateDropdown();

        if (movieList.length > 0) {
            populateForm();
        }
    });

    function populateDropdown() {
        const dropdown = document.getElementById('editMovieDropdown');
        movieList.forEach(movie => {
            let option = document.createElement('option');
            option.value = movie.name;
            option.textContent = movie.name;
            dropdown.append(option);
        });
    }

    function populateForm() {
        const selectedMovieName = document.getElementById('editMovieDropdown').value;
        const selectedMovie = movieList.find(movie => movie.name === selectedMovieName);

        document.getElementById('editName').value = selectedMovie.name;
        document.getElementById('editGenre').value = selectedMovie.genre;
        document.getElementById('editYear').value = selectedMovie.year;
        document.getElementById('editRating').value = selectedMovie.rating;
    }

    function updateMovieDetails() {
        const updatedName = document.getElementById('editName').value;
        const updatedGenre = document.getElementById('editGenre').value;
        const updatedYear = parseInt(document.getElementById('editYear').value, 10);
        const updatedRating = parseFloat(document.getElementById('editRating').value);

        // Find the movie in the movieList and update its details
        const movieToUpdate = movieList.find(movie => movie.name === updatedName);
        if (movieToUpdate) {
            movieToUpdate.genre = updatedGenre;
            movieToUpdate.year = updatedYear;
            movieToUpdate.rating = updatedRating;
        }

        pushDefaultMoviesToLocalStorage(movieList); // Update localStorage with edited details
        alert('Movie details updated!');
    }
</script>

</body>
</html>
